services:
  db:
    volumes:
      - postgres_data_dev:/var/lib/postgresql/data

  ollama:
    volumes:
      - ollama_data_dev:/root/.ollama

  api:
    build:
      target: runner
    volumes:
      - ./src:/app/src
      # Also mount alembic files for development
      - ./alembic:/app/alembic
      # Mount tests so they can be run inside the container if needed
      - ./tests:/app/tests
    # Use default entrypoint with modified worker count
    command: []

volumes:
  postgres_data_dev:
    driver: local
  ollama_data_dev:
    driver: local
